<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:viewModels="clr-namespace:dxfInspect.ViewModels"
             mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
             x:Class="dxfInspect.Views.DxfMainView"
             x:CompileBindings="True" x:DataType="viewModels:DxfViewerViewModel">

  <DockPanel Margin="8">

    <StackPanel Spacing="8" DockPanel.Dock="Top">
      <StackPanel Orientation="Horizontal" Spacing="8" DockPanel.Dock="Top">
        <Button Name="LoadButton" Content="Load DXF" />
        <Button Content="Expand All" Command="{Binding ExpandAllCommand}" />
        <Button Content="Collapse All" Command="{Binding CollapseAllCommand}" />
        <Button Content="Reset Filters" Command="{Binding ResetFiltersCommand}" />
      </StackPanel>
      <StackPanel Orientation="Horizontal" Spacing="8">
        <TextBlock Text="Code:" Width="100" VerticalAlignment="Center" />
        <TextBox Text="{Binding CodeSearch}" Width="170" />
      </StackPanel>
      <StackPanel Orientation="Horizontal" Spacing="8">
        <TextBlock Text="Data:" Width="100" VerticalAlignment="Center" />
        <TextBox Text="{Binding DataSearch}" Width="170" />
      </StackPanel>
      <StackPanel Orientation="Horizontal" Spacing="8">
        <TextBlock Text="Line Range:" Width="100" VerticalAlignment="Center" />
        <NumericUpDown Value="{Binding LineNumberStart}" Width="170" Minimum="1" />
        <TextBlock Text="-" VerticalAlignment="Center" />
        <NumericUpDown Value="{Binding LineNumberEnd}" Width="170" Minimum="1" />
      </StackPanel>
      <StackPanel Orientation="Horizontal" Spacing="8" DockPanel.Dock="Top">
        <TextBlock Text="File:" Width="100" VerticalAlignment="Center" />
        <TextBlock Name="FileNameBlock" Text="-" VerticalAlignment="Center" />
      </StackPanel>
    </StackPanel>

    <Panel Height="8" DockPanel.Dock="Top" />

    <Grid>
      <TreeDataGrid Name="DxfTree"
                    Source="{Binding Source}">
        <TreeDataGrid.Styles>
          <Style Selector="TreeDataGrid TreeDataGridRow">
            <Setter Property="ContextMenu">
              <Setter.Value>
                <ContextMenu>
                  <MenuItem Header="Filter by Line Range"
                            Command="{Binding $parent[UserControl].((viewModels:DxfViewerViewModel)DataContext).FilterByLineRangeCommand}"
                            CommandParameter="{Binding $parent[TreeDataGridRow].DataContext}" />
                  <MenuItem Header="Filter by Data"
                            Command="{Binding $parent[UserControl].((viewModels:DxfViewerViewModel)DataContext).FilterByDataCommand}"
                            CommandParameter="{Binding $parent[TreeDataGridRow].DataContext}" />
                  <MenuItem Header="Filter by Code"
                            Command="{Binding $parent[UserControl].((viewModels:DxfViewerViewModel)DataContext).FilterByCodeCommand}"
                            CommandParameter="{Binding $parent[TreeDataGridRow].DataContext}" />
                  <Separator />
                  <MenuItem Header="Reset All Filters"
                            Command="{Binding $parent[UserControl].((viewModels:DxfViewerViewModel)DataContext).ResetFiltersCommand}" />
                  <Separator />
                  <MenuItem Header="Copy Code + Data"
                            Command="{Binding $parent[UserControl].((viewModels:DxfViewerViewModel)DataContext).CopyCodeAndDataCommand}"
                            CommandParameter="{Binding $parent[TreeDataGridRow].DataContext}" />
                  <MenuItem Header="Copy Object Tree"
                            Command="{Binding $parent[UserControl].((viewModels:DxfViewerViewModel)DataContext).CopyObjectTreeCommand}"
                            CommandParameter="{Binding $parent[TreeDataGridRow].DataContext}" />
                </ContextMenu>
              </Setter.Value>
            </Setter>
          </Style>
        </TreeDataGrid.Styles>
      </TreeDataGrid>
      <TextBlock Name="PlaceholderText"
                 Text="No DXF file loaded. Click 'Load DXF' to begin."
                 HorizontalAlignment="Center"
                 VerticalAlignment="Center"
                 IsVisible="{Binding !HasLoadedFile}" />
    </Grid>

  </DockPanel>

</UserControl>
